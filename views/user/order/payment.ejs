<!-- Header -->
<%- include('../../partials/user/order_header') %>

<div class="w-full flex justify-center mt-8">
    <div class="bg-white p-8 rounded-lg shadow-lg w-1/3">
        <h2 class="text-center text-2xl font-bold mb-6">How you'll pay</h2>
        <form id="paymentForm">
            <% paymentMethods.forEach((method,index)=>{ %>
            <div class="mb-4">
                <input type="radio" value="<%= method %>" id="<%= method %>" name="payment" class="mr-2">
                <label for="<%= method %>" class="text-lg"><%= method %></label>
            </div>
            <% }) %>
            <div class="mb-6">
                <p class="text-lg">Items total: <span class="font-semibold"><%= total %></span></p>
                <p class="text-lg">Delivery fee: <span class="text-green-500 font-semibold">free</span></p>
                <hr class="my-4">
                <p class="text-xl font-bold">Total: <%= total %></p>
            </div>
            <div class="flex justify-center">
                <button type="button" class="bg-red-500 text-white py-2 px-6 rounded-full hover:bg-red-600 transition duration-300" onclick="placeOrder('<%= total %>')">Place order</button>
            </div>
            <div class="flex justify-center mt-4">
                <button type="button" class="bg-gray-300 text-gray-700 py-2 px-6 rounded-full hover:bg-gray-400 transition duration-300">Apply coupon code</button>
            </div>
        </form>
    </div>
</div>

<script>
    async function placeOrder(total) {
        const paymentType = document.querySelector('input[name="payment"]:checked').value;

        try {
            const response = await axios.post('/user/order/creation', {
                total,
                paymentType
            });
            if (response.status === 200) {
                alert("Order placed successfully!");
                // window.location.href = '/user/order/success';
            }
        } catch (error) {
            console.error("Error placing order:", error);
            alert("Failed to place order.");
        }
    }
</script>